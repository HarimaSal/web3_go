# 博客系统测试用例

以下是为博客系统的用户认证与授权、文章管理功能以及评论功能编写的测试用例，涵盖所有要求的功能点，以 Markdown 表格形式呈现。（AI生成，部分提示不一定有）

## 1. 用户认证与授权


| 测试用例 ID | 描述                                   | 前置条件                               | 测试步骤                                                                                                                                                                                                    | 预期结果                                                     |
| ----------- | -------------------------------------- | -------------------------------------- |---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| ------------------------------------------------------------ |
| TC_AUTH_001 | 验证用户可以使用有效凭据成功注册       | 数据库为空或不包含测试用户             | 1. 向`/register` 发送 POST 请求，请求体为：`{"username": "testuser", "password": "Test@123", "email": "test@example.com"}`。 2. 验证响应状态码为 200。 3. 验证响应包含消息："User registered successfully"。 4. 检查数据库，确保用户已创建且密码已加密存储。 | 用户成功创建，响应状态码为 200，数据库中密码为哈希值。       |
| TC_AUTH_002 | 验证使用重复用户名注册会失败           | 数据库中已存在用户名 "testuser"        | 1. 向`/register` 发送 POST 请求，请求体为：`{"username": "testuser", "password": "Test@123", "email": "new@example.com"}`。 2. 验证响应状态码为 500（或适当错误码）。 3. 验证响应包含错误消息，如 "Failed to register user"。 4. 检查数据库，确保未创建新用户。  | 注册失败，响应状态码为 500，数据库无新用户。                 |
| TC_AUTH_003 | 验证注册时缺少必填字段会失败           | 数据库为空                             | 1. 向`/register` 发送 POST 请求，请求体为：`{"username": "testuser"}`（缺少 password 和 email）。 2. 验证响应状态码为 400。 3. 验证响应包含错误消息，如 "Key: 'RegisterRequest.Password' Error:Field validation for 'Password' failed"。       | 注册失败，响应状态码为 400，数据库无新用户。                 |
| TC_AUTH_004 | 验证用户可以使用正确凭据登录并获取 JWT | 数据库中存在用户 "testuser"/"Test@123" | 1. 向`/login` 发送 POST 请求，请求体为：`{"username": "testuser", "password": "Test@123"}`。 2. 验证响应状态码为 200。 3. 验证响应包含有效 JWT 令牌。 4. 解析 JWT，确保包含正确的 user_id。                                                        | 登录成功，响应状态码为 200，返回有效 JWT，包含正确 user_id。 |
| TC_AUTH_005 | 验证使用错误密码登录会失败             | 数据库中存在用户 "testuser"/"Test@123" | 1. 向`/login` 发送 POST 请求，请求体为：`{"username": "testuser", "password": "Wrong@123"}`。 2. 验证响应状态码为 401。 3. 验证响应包含错误消息，如 "Invalid username or password"。                                                      | 登录失败，响应状态码为 401，无 JWT 返回。                    |
| TC_AUTH_006 | 验证使用无效 JWT 访问受保护路由会失败  | 用户已注册并登录，获取有效 JWT         | 1. 向`/article/create` 发送 POST 请求，附带无效或过期 JWT（Authorization: Bearer ）。 2. 验证响应状态码为 401。 3. 验证响应包含错误消息，如 "Invalid token"。                                                                                       | 访问失败，响应状态码为 401。                                 |

## 2. 文章管理功能


| 测试用例 ID | 描述                           | 前置条件                              | 测试步骤                                                                                                                                                                              | 预期结果                                                 |
| ----------- | ------------------------------ | ------------------------------------- |-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| -------------------------------------------------------- |
| TC_POST_001 | 验证已认证用户可以创建文章     | 用户已登录并获取有效 JWT              | 1. 向`/article/create` 发送 POST 请求，附带有效 JWT，请求体为：`{"title": "Test Post", "content": "This is a test post"}`。 2. 验证响应状态码为 200。 3. 验证响应包含文章数据（title, content, user_id）。 4. 检查数据库，确保文章已创建且 user_id 正确。 | 文章创建成功，响应状态码为 200，数据库中存在新文章。     |
| TC_POST_002 | 验证未认证用户无法创建文章     | 无 JWT 或无效 JWT                     | 1. 向`/article/create` 发送 POST 请求，不附带 JWT 或使用无效 JWT，请求体为：`{"title": "Test Post", "content": "This is a test post"}`。 2. 验证响应状态码为 401。 3. 验证响应包含错误消息，如 "Authorization header required" 或 "Invalid token"。 | 文章创建失败，响应状态码为 401，数据库无新文章。         |
| TC_POST_003 | 验证可以获取所有文章列表       | 数据库中存在至少 2 篇文章             | 1. 向`/article/listAll` 发送 GET 请求（无需认证）。 2. 验证响应状态码为 200。 3. 验证响应包含文章列表，且列表长度正确。                                                                                                     | 响应状态码为 200，返回所有文章列表。                     |
| TC_POST_004 | 验证可以获取单个文章的详细信息 | 数据库中存在 ID 为 1 的文章           | 1. 向`/article/1` 发送 GET 请求（无需认证）。 2. 验证响应状态码为 200。 3. 验证响应包含文章的 title、content 和 user_id。                                                                                          | 响应状态码为 200，返回正确文章数据。                     |
| TC_POST_005 | 验证获取不存在的文章会失败     | 数据库中无 ID 为 999 的文章           | 1. 向`/article/999` 发送 GET 请求。 2. 验证响应状态码为 404。 3. 验证响应包含错误消息，如 "Post not found"。                                                                                                  | 响应状态码为 404，返回错误消息。                         |
| TC_POST_006 | 验证文章作者可以更新自己的文章 | 用户已登录，拥有 ID 为 1 的文章       | 1. 向`/article/1` 发送 PUT 请求，附带有效 JWT，请求体为：`{"title": "Updated Post", "content": "Updated content"}`。 2. 验证响应状态码为 200。 3. 验证响应包含更新后的文章数据。 4. 检查数据库，确保文章已更新。                         | 文章更新成功，响应状态码为 200，数据库中文章数据已更新。 |
| TC_POST_007 | 验证非作者无法更新文章         | 用户已登录，但不是 ID 为 1 的文章作者 | 1. 向`/article/1` 发送 PUT 请求，附带有效 JWT，请求体为：`{"title": "Updated Post", "content": "Updated content"}`。 2. 验证响应状态码为 403。 3. 验证响应包含错误消息，如 "You are not authorized to update this post"。 | 更新失败，响应状态码为 403，数据库中文章未更改。         |
| TC_POST_008 | 验证文章作者可以删除自己的文章 | 用户已登录，拥有 ID 为 1 的文章       | 1. 向`/article/1` 发送 DELETE 请求，附带有效 JWT。 2. 验证响应状态码为 200。 3. 验证响应包含消息，如 "Post deleted successfully"。 4. 检查数据库，确保文章已被删除。                                                            | 文章删除成功，响应状态码为 200，数据库中文章已删除。     |
| TC_POST_009 | 验证非作者无法删除文章         | 用户已登录，但不是 ID 为 1 的文章作者 | 1. 向`/article/1` 发送 DELETE 请求，附带有效 JWT。 2. 验证响应状态码为 403。 3. 验证响应包含错误消息，如 "You are not authorized to delete this post"。                                                            | 删除失败，响应状态码为 403，数据库中文章未删除。         |

## 3. 评论功能


| 测试用例 ID    | 描述                             | 前置条件                                       | 测试步骤                                                                                                                                                                                      | 预期结果                                             |
| -------------- | -------------------------------- | ---------------------------------------------- |-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| ---------------------------------------------------- |
| TC_COMMENT_001 | 验证已认证用户可以对文章发表评论 | 用户已登录，数据库中存在 ID 为 1 的文章        | 1. 向`/comment/create` 发送 POST 请求，附带有效 JWT，请求体为：`{"content": "This is a test comment"}`。 2. 验证响应状态码为 200。 3. 验证响应包含评论数据（content, user_id, post_id）。 4. 检查数据库，确保评论已创建且 user_id 和 post_id 正确。 | 评论创建成功，响应状态码为 200，数据库中存在新评论。 |
| TC_COMMENT_002 | 验证未认证用户无法发表评论       | 无 JWT 或无效 JWT                              | 1. 向`/comment/create` 发送 POST 请求，不附带 JWT 或使用无效 JWT，请求体为：`{"content": "This is a test comment"}`。 2. 验证响应状态码为 401。 3. 验证响应包含错误消息，如 "Authorization header required" 或 "Invalid token"。     | 评论创建失败，响应状态码为 401，数据库无新评论。     |
| TC_COMMENT_003 | 验证对不存在的文章发表评论会失败 | 数据库中无 ID 为 999 的文章                    | 1. 向`/comment/create` 发送 POST 请求，附带有效 JWT，请求体为：`{"content": "This is a test comment"}`。 2. 验证响应状态码为 404。 3. 验证响应包含错误消息，如 "Post not found"。                                               | 评论创建失败，响应状态码为 404，数据库无新评论。     |
| TC_COMMENT_004 | 验证可以获取某篇文章的所有评论   | 数据库中存在 ID 为 1 的文章，且有至少 2 条评论 | 1. 向`/comment/1` 发送 GET 请求（无需认证）。 2. 验证响应状态码为 200。 3. 验证响应包含评论列表，且列表长度正确。                                                                                                                 | 响应状态码为 200，返回所有评论列表。                 |
| TC_COMMENT_005 | 验证获取不存在文章的评论会失败   | 数据库中无 ID 为 999 的文章                    | 1. 向`/comment/999` 发送 GET 请求。 2. 验证响应状态码为 400（或适当错误码）。 3. 验证响应包含错误消息，如 "Invalid post ID"。                                                                                                 | 响应状态码为 400，返回错误消息。                     |
